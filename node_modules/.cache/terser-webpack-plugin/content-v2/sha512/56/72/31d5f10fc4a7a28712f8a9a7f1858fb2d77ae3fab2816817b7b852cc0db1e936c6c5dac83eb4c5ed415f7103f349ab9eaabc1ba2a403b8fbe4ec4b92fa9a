{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{645:function(e,t,s){\"use strict\";s.r(t);var r=[function(){var e=this.$createElement,t=this._self._c||e;return t(\"div\",{staticClass:\"header1\"},[t(\"div\",{staticClass:\"logo\"},[t(\"img\",{staticStyle:{width:\"100px\",height:\"100px\",\"margin-left\":\"10px\"},attrs:{src:s(648)}}),this._v(\" \"),t(\"div\",{staticStyle:{color:\"darkslategray\",\"font-size\":\"20px\",\"font-weight\":\"bold\"}},[this._v(\"siushare.com\")])]),this._v(\" \"),t(\"div\",{staticClass:\"title\"},[t(\"span\",[t(\"p\",{staticStyle:{\"font-size\":\"25px\",\"font-family\":\"'Apple Color Emoji'\",position:\"absolute\",\"margin-left\":\"-30px\",\"margin-top\":\"75px\"}},[this._v(\"欢迎登录\")])])])])}],i={data(){return{show2:!1,loading:!1,identifyCodes:\"1234567890\",identifyCode:\"\",show:!0,count:\"\",timer:null,errors:\"\",error:!1,param:{username:\"\",password:\"\",validate:\"\"},rules:{username:[{required:!0,message:\"请输入用户名\",trigger:\"blur\"}],password:[{required:!0,message:\"请输入密码\",trigger:\"blur\"}],validate:[{required:!0,message:\"请输入验证码\",trigger:\"blur\"}]},ruleForm:{newPassword:\"\",checkPass:\"\",password:\"\",code:\"\",mobile:\"\"},rules2:{newPassword:[{validator:(e,t,s)=>{\"\"===t?s(new Error(\"请输入密码\")):(\"\"!==this.ruleForm.checkPass&&this.$refs.ruleForm.validateField(\"checkPass\"),s())},required:!0,trigger:\"blur\"},{required:!0,message:\"请输入密码\",trigger:\"blur\"},{min:5,max:25,message:\"长度在 5 到 25个字符\"},{pattern:/^(\\w){5,25}$/,message:\"只能输入5-25个字母、数字、下划线\"}],checkPass:[{validator:(e,t,s)=>{\"\"===t?s(new Error(\"请再次输入密码\")):t!==this.ruleForm.newPassword?s(new Error(\"两次输入密码不一致!\")):s()},required:!0,trigger:\"blur\"},{required:!0,message:\"请输入密码\",trigger:\"blur\"},{min:5,max:25,message:\"长度在 5 到 25个字符\"},{pattern:/^(\\w){5,25}$/,message:\"只能输入5-25个字母、数字、下划线\"}],password:[{required:!0,message:\"请输入旧密码\",trigger:\"blur\"}],code:[{required:!0,message:\"请输入验证码\",trigger:\"blur\"}],mobile:[{required:!0,message:\"请输入手机号\",trigger:\"blur\"},{pattern:/^1[3456789]\\d{9}$/,message:\"请输入格式正确的手机号\"}]}}},methods:{submitForm(){this.loading=!0,this.param.validate===this.identifyCode?this.$refs.login.validate(e=>{if(!e)return this.$message.error(\"请输入账号和密码\"),console.log(\"error submit!!\"),!1;this.$axios.post(this.$api.login,this.$qs.stringify(this.param),{headers:{\"Content-Type\":\"application/x-www-form-urlencoded\",timeout:5e3}}).then(e=>{if(localStorage.setItem(\"ms_username\",this.param.username),console.log(JSON.parse(e.data.msg)),null!=e){if(1==JSON.parse(e.data.msg).role){this.loading=!1,localStorage.setItem(\"identity\",JSON.parse(e.data.msg).role),console.log(\"普通用户\"),sessionStorage.setItem(\"role\",\"普通用户\"),console.log(this.$route.query.redirect);let t=decodeURIComponent(this.$route.query.redirect||\"/\");this.$router.push({path:t})}else if(2==JSON.parse(e.data.msg).role){this.loading=!1,localStorage.setItem(\"identity\",JSON.parse(e.data.msg).role),console.log(\"商家\"),sessionStorage.setItem(\"role\",\"商家\"),console.log(this.$route.query.redirect);let t=decodeURIComponent(this.$route.query.redirect||\"/\");this.$router.push({path:t})}else if(3==JSON.parse(e.data.msg).role){this.loading=!1,localStorage.setItem(\"identity\",JSON.parse(e.data.msg).role),sessionStorage.setItem(\"role\",\"商家\"),console.log(\"分享者\"),console.log(this.$route.query.redirect);let t=decodeURIComponent(this.$route.query.redirect||\"/\");this.$router.push({path:t})}else this.loading=!1,this.$message.error(\"未知错误，请稍后再尝试1\")}else this.loading=!1,this.$message.error(\"未知错误，请稍后再尝试2\")})}):(this.param.username=\"\",this.param.password=\"\",this.param.validate=\"\",this.refreshCode(),this.$message.error(\"验证码错误\"),this.loading=!1)},randomNum:(e,t)=>Math.floor(Math.random()*(t-e)+e),refreshCode(){this.identifyCode=\"\",this.makeCode(this.identifyCodes,4)},makeCode(e,t){for(let e=0;e<t;e++)this.identifyCode+=this.identifyCodes[this.randomNum(0,this.identifyCodes.length)];console.log(this.identifyCode)},goRegister(){this.$router.push(\"/register\")},gosmsLogin(){this.$router.push(\"/smslogin\")},submitForm2(e){this.$refs[e].validate(e=>{if(!e)return console.log(\"error submit!!\"),!1;this.$axios.post(\"/api/editUserPassword\",this.$qs.stringify(this.ruleForm),{headers:{\"Content-Type\":\"application/x-www-form-urlencoded\"}}).then(e=>{console.log(e.data.code),200==e.data.code?(this.$notify({title:\"成功\",message:\"修改成功\",type:\"success\"}),this.$router.push(\"/login\")):80==e.data.code&&this.$notify.error({title:\"错误\",message:\"验证码错误\"})})})},resetForm(e){this.$refs[e].resetFields()},getCode(){let e=this.ruleForm.password,t=this.ruleForm.newPassword,s=this.ruleForm.checkPass;if(e&&t&&s)if(t!==s)this.errors=\"两次密码不一致\";else{this.$axios.get(\"/api/editUserPassword/sms\",{params:{mobile:this.ruleForm.mobile}}).then(e=>{console.log(\"aaa\")});const e=60;this.error=!1,this.timer||(this.count=e,this.show=!1,this.timer=setInterval(()=>{this.count>0&&this.count<=e?this.count--:(this.show=!0,clearInterval(this.timer),this.timer=null)},1e3))}else this.error=!0,this.errors=\"资料不能为空\";console.log(this.ruleForm.password)}},mounted(){this.identifyCode=\"\",this.makeCode(this.identifyCodes,4)}},o=(s(731),s(64)),a=Object(o.a)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",[e._m(0),e._v(\" \"),s(\"div\",{attrs:{id:\"login-wrap\"}},[s(\"div\",{staticClass:\"ms-login\"},[s(\"div\",{staticClass:\"ms-title\",staticStyle:{color:\"black\"}},[e._v(\"登录\")]),e._v(\" \"),s(\"el-form\",{ref:\"login\",staticClass:\"ms-content\",attrs:{model:e.param,rules:e.rules,\"label-width\":\"0px\"}},[s(\"el-form-item\",{attrs:{prop:\"username\"}},[s(\"i\",{staticClass:\"el-icon-lx-people\",staticStyle:{display:\"inline-block\"}}),e._v(\" \"),s(\"el-input\",{staticStyle:{display:\"inline-block\",width:\"270px\"},attrs:{placeholder:\"username\",autocomplete:\"off\"},model:{value:e.param.username,callback:function(t){e.$set(e.param,\"username\",t)},expression:\"param.username\"}})],1),e._v(\" \"),s(\"el-form-item\",{attrs:{prop:\"password\"}},[s(\"i\",{staticClass:\"el-icon-lx-lock\",staticStyle:{display:\"inline-block\"}}),e._v(\" \"),s(\"el-input\",{staticStyle:{display:\"inline-block\",width:\"270px\"},attrs:{type:\"password\",placeholder:\"password\",autocomplete:\"off\"},nativeOn:{keyup:function(t){return!t.type.indexOf(\"key\")&&e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?null:e.submitForm()}},model:{value:e.param.password,callback:function(t){e.$set(e.param,\"password\",t)},expression:\"param.password\"}})],1),e._v(\" \"),s(\"el-form-item\",{attrs:{prop:\"validate\"}},[s(\"el-input\",{staticClass:\"validate-code\",staticStyle:{display:\"inline-block\",width:\"150px\"},attrs:{placeholder:\"验证码\"},model:{value:e.param.validate,callback:function(t){e.$set(e.param,\"validate\",t)},expression:\"param.validate\"}}),e._v(\" \"),s(\"div\",{staticClass:\"code\",staticStyle:{display:\"inline-block\"},on:{click:e.refreshCode}},[s(\"s-identify\",{attrs:{identifyCode:e.identifyCode}})],1)],1),e._v(\" \"),s(\"div\",{staticClass:\"login-btn\"},[s(\"el-button\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:e.loading,expression:\"loading\"}],staticStyle:{display:\"inline-block\",width:\"130px\"},attrs:{type:\"primary\"},on:{click:function(t){return e.submitForm()}}},[e._v(\"登录\\n                        \")]),e._v(\" \"),s(\"el-button\",{staticStyle:{display:\"inline-block\",width:\"130px\"},attrs:{type:\"success\"},on:{click:function(t){return e.goRegister()}}},[e._v(\"注册\\n                        \")])],1),e._v(\" \"),s(\"el-link\",{staticStyle:{display:\"inline-block\",color:\"#222222\"},attrs:{type:\"info\"},on:{click:function(t){e.show2=!e.show2}}},[e._v(\"忘记密码?\")]),e._v(\" \"),s(\"el-link\",{staticStyle:{display:\"inline-block\",\"margin-left\":\"160px\",color:\"#222222\",position:\"absolute\",\"margin-top\":\"5px\"},attrs:{type:\"info\"},on:{click:function(t){return e.gosmsLogin()}}},[e._v(\"手机登录\\n                    \")]),e._v(\" \"),s(\"el-form-item\",[s(\"el-switch\",{staticStyle:{display:\"inline-block\",\"margin-left\":\"200px\"},model:{value:e.param.rememberMe,callback:function(t){e.$set(e.param,\"rememberMe\",t)},expression:\"param.rememberMe\"}}),e._v(\" \"),s(\"p\",{staticStyle:{display:\"inline-block\"}},[e._v(\"记住我\")])],1)],1)],1)]),e._v(\" \"),s(\"div\",{staticStyle:{\"text-align\":\"center\",\"margin-top\":\"15px\",\"font-size\":\"20px\"}},[s(\"el-link\",{attrs:{type:\"primary\",href:\"/\"}},[e._v(\"关于我们\")]),e._v(\"\\n            |\\n            \"),s(\"el-link\",{attrs:{type:\"primary\",href:\"/\"}},[e._v(\"联系我们\")]),e._v(\"\\n            |\\n            \"),s(\"el-link\",{attrs:{type:\"primary\",href:\"/\"}},[e._v(\"广告服务\")])],1),e._v(\" \"),s(\"div\",{staticStyle:{\"text-align\":\"center\",\"margin-top\":\"15px\",\"font-size\":\"15px\"}},[e._v(\"Copyright @ 2019-2020 siushare.com 版权所有\")]),e._v(\" \"),s(\"el-dialog\",{attrs:{title:\"提示\",visible:e.show2,width:\"400px\"},on:{\"update:visible\":function(t){e.show2=t}}},[s(\"el-form\",{ref:\"ruleForm\",staticClass:\"demo-ruleForm\",attrs:{model:e.ruleForm,\"status-icon\":\"\",rules:e.rules2,\"label-width\":\"100px\"}},[s(\"el-form-item\",{staticStyle:{width:\"300px\"},attrs:{label:\"旧密码\",prop:\"password\"}},[s(\"el-input\",{model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,\"password\",e._n(t))},expression:\"ruleForm.password\"}})],1),e._v(\" \"),s(\"el-form-item\",{staticStyle:{width:\"300px\"},attrs:{label:\"密码\",prop:\"newPassword\"}},[s(\"el-input\",{attrs:{type:\"password\",autocomplete:\"off\"},model:{value:e.ruleForm.newPassword,callback:function(t){e.$set(e.ruleForm,\"newPassword\",t)},expression:\"ruleForm.newPassword\"}})],1),e._v(\" \"),s(\"el-form-item\",{staticStyle:{width:\"300px\"},attrs:{label:\"确认密码\",prop:\"checkPass\"}},[s(\"el-input\",{attrs:{type:\"password\",autocomplete:\"off\"},model:{value:e.ruleForm.checkPass,callback:function(t){e.$set(e.ruleForm,\"checkPass\",t)},expression:\"ruleForm.checkPass\"}})],1),e._v(\" \"),s(\"el-form-item\",{staticStyle:{width:\"300px\"},attrs:{label:\"手机号\",prop:\"mobile\"}},[s(\"el-input\",{attrs:{type:\"text\",autocomplete:\"off\"},model:{value:e.ruleForm.mobile,callback:function(t){e.$set(e.ruleForm,\"mobile\",t)},expression:\"ruleForm.mobile\"}})],1),e._v(\" \"),s(\"el-form-item\",{staticStyle:{width:\"200px\",display:\"inline-block\"},attrs:{label:\"验证码\",prop:\"code\"}},[s(\"el-input\",{attrs:{type:\"text\",autocomplete:\"off\"},model:{value:e.ruleForm.code,callback:function(t){e.$set(e.ruleForm,\"code\",t)},expression:\"ruleForm.code\"}})],1),e._v(\" \"),s(\"el-form-item\",{staticStyle:{display:\"inline-block\",position:\"absolute\",\"margin-left\":\"-90px\"}},[e.show?s(\"el-button\",{attrs:{type:\"primary\",plain:\"\",size:\"mini\"},on:{click:function(t){return e.getCode()}}},[e._v(\"获取验证码\")]):s(\"el-button\",{attrs:{type:\"primary\",plain:\"\",size:\"mini\",disabled:\"\"},on:{click:function(t){return e.getCode()}}},[e._v(\"获取验证码\")])],1),e._v(\" \"),e.error?s(\"div\",{staticStyle:{color:\"red\",\"font-size\":\"10px\",\"margin-left\":\"180px\",\"margin-top\":\"-15px\"}},[e._v(e._s(e.errors))]):e._e(),e._v(\" \"),e.show?e._e():s(\"div\",{staticStyle:{color:\"#5daf34\",\"font-size\":\"10px\",\"margin-left\":\"130px\",\"margin-top\":\"-15px\"}},[e._v(\"短信已发送，\"+e._s(e.count)+\"s后重新发送\")]),e._v(\" \"),s(\"el-form-item\",[s(\"el-button\",{staticStyle:{width:\"85%\"},attrs:{type:\"primary\"},on:{click:function(t){return e.submitForm2(\"ruleForm\")}}},[e._v(\"提交\")])],1),e._v(\" \"),s(\"el-form-item\",[s(\"el-button\",{staticStyle:{width:\"85%\"},attrs:{size:\"medium\"},on:{click:function(t){return e.resetForm(\"ruleForm\")}}},[e._v(\"重置\")])],1)],1),e._v(\" \"),s(\"span\",{staticClass:\"dialog-footer\",attrs:{slot:\"footer\"},slot:\"footer\"})],1)],1)}),r,!1,null,\"4e89cf28\",null);t.default=a.exports},648:function(e,t,s){e.exports=s.p+\"assets/images/logo.png\"},678:function(e,t,s){var r=s(732);\"string\"==typeof r&&(r=[[e.i,r,\"\"]]),r.locals&&(e.exports=r.locals);(0,s(158).default)(\"6df42712\",r,!0,{})},731:function(e,t,s){\"use strict\";var r=s(678);s.n(r).a},732:function(e,t,s){}}]);","extractedComments":[]}